<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">Certificate background | ManySecured</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Certificate background | ManySecured"><meta data-react-helmet="true" name="description" content="Non TLS based security"><meta data-react-helmet="true" property="og:description" content="Non TLS based security"><meta data-react-helmet="true" property="og:url" content="https://github.com/TechWorksHub/ManySecured-SUIB/docs/4-certificate-background"><link data-react-helmet="true" rel="shortcut icon" href="/ManySecured-SUIB/img/mslogo.svg"><link data-react-helmet="true" rel="canonical" href="https://github.com/TechWorksHub/ManySecured-SUIB/docs/4-certificate-background"><link rel="stylesheet" href="/ManySecured-SUIB/styles.e6e8e8cd.css">
<link rel="preload" href="/ManySecured-SUIB/styles.d5bc23c9.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/runtime~main.b896b639.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/main.0a8fe152.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/1.0b59496a.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/2.518673a7.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/44.4c0d6cd3.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/45.de83f5cd.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/8f7864a0.83684284.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/17896441.d296467f.js" as="script">
<link rel="preload" href="/ManySecured-SUIB/05216698.28ca7267.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/ManySecured-SUIB/"><img class="navbar__logo" src="/ManySecured-SUIB/img/mslogo.svg" alt="NQM Docusaurus Template Logo"><strong class="navbar__title">ManySecured</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ManySecured-SUIB/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/ManySecured-SUIB/docs/about">About</a><a href="https://github.com/TechWorksHub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/ManySecured-SUIB/"><img class="navbar__logo" src="/ManySecured-SUIB/img/mslogo.svg" alt="NQM Docusaurus Template Logo"><strong class="navbar__title">ManySecured</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/ManySecured-SUIB/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/ManySecured-SUIB/docs/about">About</a></li><li class="menu__list-item"><a href="https://github.com/TechWorksHub" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">SUIB</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/problem-overview">SUIB problem Summmary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/1b-solution-overview">Solution Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/2-addressing-background">Addressing background</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/3-browser-background">Browser background</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/ManySecured-SUIB/docs/4-certificate-background">Certificate background</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/7-browser-solution">Browser integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/7-browser-solution">Browser integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/8-dnsname-embedded-solution">DNS Based Device Name - Embedded physical address</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/9-dnsname-dynamic-solution">DNS Based Device Name - Dynamic DNS resolution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/10-gateway-solution">Gateway issued certificate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/ManySecured-SUIB/docs/11-application-solution">Application issued certificate</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Certificate background</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="non-tls-based-security"></a>Non TLS based security<a aria-hidden="true" tabindex="-1" class="hash-link" href="#non-tls-based-security" title="Direct link to heading">#</a></h2><p>TLS enables encryption on the session layer, but it&#x27;s possible to provide encryption for different protocols or in a different layer.</p><p>If the device is in possession of a public private key pair, the device may sign one or more tokens, relating to the status of the devices.</p><p>In addition the device may be in possession of tokens signed by externally recognised authorities, that containing the devices public key, which also express key information relating to the status of the device.</p><p>The only real difference here relates to the expression of the claim. For example these claims could be rendered as JWT&#x27;s, CBOR Object Signing and Encryption and Verified Credentials.</p><p>?? This method would require changes to the TLS stack, to accommodate these new credentials as part of the authorisation negotiation. ??</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="existing-tls-certificate-practices"></a>Existing TLS certificate practices<a aria-hidden="true" tabindex="-1" class="hash-link" href="#existing-tls-certificate-practices" title="Direct link to heading">#</a></h2><p>Certificates are currently being used for deployed IOT devices. Many gateways and IoT devices host a both a HTTP and a HTTPS webserver for device onboarding and device management purposes. Users are most often directed to the HTTP administrative web server for the following reasons:</p><ol><li>The aggressive security warnings disconcert users, leading to support calls.</li><li>Many browsers make it quite difficult to &quot;click through&quot; past the warning to the &quot;insecure&quot; destination web page.</li></ol><p>A solution that embraces the use of well-formed X.509 certificates will have to be combined with new browser behaviours (above section) if it is to be useful.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="certificate-semantics-and-security-bootstrap"></a>Certificate Semantics and Security Bootstrap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#certificate-semantics-and-security-bootstrap" title="Direct link to heading">#</a></h3><p>When the browser connects to the gateway or end point device over HTTPS, the characteristics of the security established are determined by both the characteristics of the certificate being used, and the mechanism by which the certificate was provisioned on the device. (Viable methods of revocation are also relevant). In order to fully understand the qualities of the various solutions, it is worth outlining different options:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="0-no-certificate"></a>0. No certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#0-no-certificate" title="Direct link to heading">#</a></h4><p>In the simplest case there is no certificate and the website is hosted unencrypted</p><p>This method is the defector standard. It should be strongly discouraged. It fails to implement zero trust principles. It leaves critical information, in particular passwords, in the clear.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="1-non-device-unique---self-signed-certificate"></a>1. Non device unique - self-signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#1-non-device-unique---self-signed-certificate" title="Direct link to heading">#</a></h4><p>In this scenario the exact same certificate is burned into &quot;all devices&quot; of this class.</p><p>The certificate subject common name is the same as the issuer common name. The certificate is signed by itself. The common name can be arbitrary.</p><p>This method will generate browser errors under CA/Browser forum current guidelines.</p><p>This method is actively being used by some device manufacturers.</p><p>This method should be discouraged.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="2-non-device-unique---untrusted-root-signed-certificate"></a>2. Non device unique - untrusted root-signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#2-non-device-unique---untrusted-root-signed-certificate" title="Direct link to heading">#</a></h4><p>In this scenario the exact same certificate is burned into &quot;all devices&quot; of this class.</p><p>The certificate is signed by an untrusted root.</p><p>By untrusted we mean the signing authority does not correspond to any authority recognised by convention in most web browsers</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="3-device-unique---self-signed-certificate"></a>3. Device unique - self-signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#3-device-unique---self-signed-certificate" title="Direct link to heading">#</a></h4><p>In this scenario a public/private key pair is generated unique to this device.</p><p>This key pair could be generated in the factory, or during device initialisation.</p><p>The common name could be</p><ol><li>Arbitrary text: e.g. &quot;pre-set certificate&quot;.</li><li>MAC address: presumably unique to this device, but meaningless in current browser-based certificate check.</li><li>Unique device address: e.g. GUID.</li></ol><p>This class of certificate is self-signed</p><p>This method will fail the certificate verification under current CA/Browser Forum guidelines and would generate browser errors, unless an exception is accepted for the certificate.</p><p>Both these methods 2 and 3 are in use today on real deployed devices. This method generates strong warnings on current browsers.</p><p>These warnings could be made more usable with browser changes.</p><p>These methods introduce a weakness, that that compromised private key credentials taken from the device mean that it is very easy to &quot;spoof&quot; a manufacture end point device.</p><p>These methods should be discouraged.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="4-device-unique---untrusted-root-signed-certificate"></a>4. Device unique - untrusted root-signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#4-device-unique---untrusted-root-signed-certificate" title="Direct link to heading">#</a></h4><p>This scenario is like scenario 2, but instead of self-signing the certificate, it is signed by an untrusted root.</p><p>It is the same as scenario 5, but the root certificate is not pre-approved in the browser.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="5-device-unique---locally-signed-certificate"></a>5. Device unique - locally-signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#5-device-unique---locally-signed-certificate" title="Direct link to heading">#</a></h4><p>In this method a certificate is signed by binding a unique device common name to a unique public key for this end point device.</p><p>This certificate is signed by a local entity, for example a mobile application or a gateway hosted signing service.</p><p>For this method to work:</p><ul><li>A CSR must be generated as part of a one-off binding event.</li><li>The CSR must be issued to and processed by the local service.</li><li>The end point address used in the CSR, must resolve locally.</li></ul><p>This method requires all the browsers on all the systems to add the gateway certificate that has signed all the local certificates. This requires the certificates to remain local. This may cause problems when internet servers start serving local certificates, but the common name would not match the certificate.</p><p>These methods are all slight variants of one another. They improve on 1&amp;2 in that the impact of private key compromise is limited.</p><p>The private key per device could be implemented at different points in the lifecycle.</p><p>Browser changes are required to unpack the certificate and establish a qualified measure of trust from the signatures, and any a priority trust base provisioned into the modified browser.</p><p>These use facing impacts of this trust base will need to be presented to the user.</p><p>Many of the solutions below, are examples of this solution</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="6-device-unique---ca-root-signed-certificate"></a>6. Device unique - CA root signed certificate<a aria-hidden="true" tabindex="-1" class="hash-link" href="#6-device-unique---ca-root-signed-certificate" title="Direct link to heading">#</a></h4><p>In this method a certificate is signed binding a unique device common name, to a unique public key on this end point device.</p><p>This certificate is signed by one of the trusted roots that the browsers use.</p><p>For this method to work:</p><ul><li>A CSR must be generated as part of a one-off binding event.</li><li>The CSR must be issued to and signed by one of the Root CAs.</li><li>The common name used in the CSR must be publicly DNS resolvable, at least for the duration of the signing.</li></ul><p>This method can be used without generating any browser security warnings. It is the method used by the flexible names Device DNS Name solution.</p><p>Device DNS Name provides a description of how we may achieve this method. This is still under investigation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="alternative-root-of-trust"></a>Alternative Root of Trust<a aria-hidden="true" tabindex="-1" class="hash-link" href="#alternative-root-of-trust" title="Direct link to heading">#</a></h2><p><strong>Solution</strong></p><p>To solve the problem of establishing a trusted secure connection between a browser and a locally hosted web server, we could look outside of traditional TLS certificate semantics and use alternative methods to negotiate a secure TLS session and represent the results of this negotiation.</p><p>There are multiple sources of such information from which security could be established. Some of these methods could work in isolation, others can be combined.</p><p>Each of these methods could complement, or replace the existing root of trust negotiation method.</p><p>The results of this security negotiation could be manifest in a classic X.509 certificate, in which case we may make use of Extended Key Usage (see below), it could be made manifest in a more complex key signing hierarchies (with multiple additional root of trust) , or it could be made manifest in non certificate based representation (see below).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="iot-certificate-key-usage"></a>IoT Certificate Key Usage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iot-certificate-key-usage" title="Direct link to heading">#</a></h2><p>Certificates have the parameter fields Key Usage and Extended Key Usage. These parameters describe the purpose of the certificate. For certificates used on the internet the extended key usage is set to server authentication (id-kp 1): <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3</a></p><p>The key usage parameters of a normal certificate are typically Digital Signature, Key Encipherment and Client and Server Authentication. Other extended key usages are for client authentication, code signing, email protection and timestamping.</p><p>A new extended key usage dedicated to IoT could create a certificate class which would be allowed to be signed by a certification authority, vendor or any other authority. Browsers would be able to distinguish the certificate to be of local significance only.</p><p>id-kp 10 could be assigned as Local Device. Since this is different than a normal Server Authentication certificate the browser can check that the connection is local and the certificate is signed by a device vendor or IoT authority (FIDO, Matter, CACERT) that acts as root for these certificates.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/TechWorksHub/ManySecured-SUIB/docs/4-certificate-background.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ManySecured-SUIB/docs/3-browser-background"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Browser background</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ManySecured-SUIB/docs/7-browser-solution"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Browser integration »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#non-tls-based-security" class="table-of-contents__link">Non TLS based security</a></li><li><a href="#existing-tls-certificate-practices" class="table-of-contents__link">Existing TLS certificate practices</a><ul><li><a href="#certificate-semantics-and-security-bootstrap" class="table-of-contents__link">Certificate Semantics and Security Bootstrap</a></li></ul></li><li><a href="#alternative-root-of-trust" class="table-of-contents__link">Alternative Root of Trust</a></li><li><a href="#iot-certificate-key-usage" class="table-of-contents__link">IoT Certificate Key Usage</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ManySecured-SUIB/">Index</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contact Us</h4><ul class="footer__items"><li class="footer__item"><a href="https://nquiringminds.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://twitter.com/nqminds" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://nquiringminds.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="NquiringMinds Logo" src="/ManySecured-SUIB/img/nqminds-logo.svg"></a></div><div>Copyright © 2021 NquiringMinds LTD. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ManySecured-SUIB/styles.d5bc23c9.js"></script>
<script src="/ManySecured-SUIB/runtime~main.b896b639.js"></script>
<script src="/ManySecured-SUIB/main.0a8fe152.js"></script>
<script src="/ManySecured-SUIB/1.0b59496a.js"></script>
<script src="/ManySecured-SUIB/2.518673a7.js"></script>
<script src="/ManySecured-SUIB/44.4c0d6cd3.js"></script>
<script src="/ManySecured-SUIB/45.de83f5cd.js"></script>
<script src="/ManySecured-SUIB/8f7864a0.83684284.js"></script>
<script src="/ManySecured-SUIB/17896441.d296467f.js"></script>
<script src="/ManySecured-SUIB/05216698.28ca7267.js"></script>
</body>
</html>